{"remainingRequest":"D:\\WorkSpace\\IdeaProjects\\harrier\\harrier-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\WorkSpace\\IdeaProjects\\harrier\\harrier-ui\\src\\view\\spdb\\systemsetting\\weightType\\Form.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\WorkSpace\\IdeaProjects\\harrier\\harrier-ui\\src\\view\\spdb\\systemsetting\\weightType\\Form.vue","mtime":1681468306550},{"path":"D:\\WorkSpace\\IdeaProjects\\harrier\\harrier-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\WorkSpace\\IdeaProjects\\harrier\\harrier-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"D:\\WorkSpace\\IdeaProjects\\harrier\\harrier-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\WorkSpace\\IdeaProjects\\harrier\\harrier-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\r\nconst RESOURCE_PATH = '/udsJobWeightLimit'\r\n\r\nexport default {\r\n  props: {\r\n    transData: {\r\n      type: Object,\r\n      default: function () {\r\n    \t\t\treturn {}\r\n      }\r\n    }\r\n  \t},\r\n  data () {\r\n    const validateTimeWindow = (rule, value, callback) => {\r\n      if (!this.formBean.timeWindowS || !this.formBean.timeWindowE) {\r\n        return callback(new Error('请选择时间'))\r\n      } else {\r\n        return callback()\r\n      }\r\n    }\r\n    return {\r\n      serverData: [],\r\n      limitTypeData: [],\r\n      formBean: {},\r\n      saveLoding: false,\r\n      disabledStatus: false,\r\n      formRule: {\r\n        limitType: [{\r\n          required: true,\r\n          message: '请输入数据！'\r\n        }],\r\n        limitValue: [{\r\n          required: true,\r\n          type: 'number',\r\n          message: '请输入数据！'\r\n        }],\r\n        serverId: [{\r\n          required: true,\r\n          message: '请选择机器！'\r\n        }],\r\n        timeWindow: [{\r\n          validator: validateTimeWindow, trigger: 'blur'\r\n        }]\r\n        // presentValue: [{\r\n        //   required: true,\r\n        //   message: '请输入数据！'\r\n        // }]\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    /**\r\n\t\t * 初始化\r\n\t\t **/\r\n    init () {\r\n      if (this.transData.id) { // 如果传过来的存在ID则说明是编辑功能跳转过来\r\n        this.disabledStatus = true\r\n        let loadConfig = {\r\n          method: 'GET',\r\n          url: RESOURCE_PATH + '/getDetail',\r\n          params: { id: this.transData.id }\r\n        }\r\n        this.$ajax(loadConfig)\r\n          .then(resp => {\r\n            let tmp = Object.assign({}, resp.data)\r\n            tmp.serverId = tmp.serverIds.split(',')\r\n            tmp.timeWindowS = tmp.timeWinds.split('-')[0]\r\n            tmp.timeWindowE = tmp.timeWinds.split('-')[1]\r\n            this.formBean = Object.assign({}, tmp)\r\n          })\r\n      } else {\r\n        this.bindData()\r\n      }\r\n    },\r\n    /**\r\n\t\t * 如果传过来的有初始数据则进行数据绑定\r\n\t\t **/\r\n    bindData () {\r\n      try {\r\n        this.formBean = Object.assign({}, this.transData.initFormBean)\r\n        this.formBean.limitValue = 1 // 设置初始值\r\n      } catch (error) {\r\n        console.error(error)\r\n      }\r\n    },\r\n    /**\r\n\t\t * 保存表单\r\n\t\t **/\r\n    save () {\r\n      this.saveLoding = true\r\n      this.$refs.udsjobweightlimitForm.validate(valid => {\r\n        if (!valid) {\r\n          this.saveLoding = false\r\n          return\r\n        }\r\n        let params = {}\r\n        Object.assign(params, this.formBean)\r\n        params.authps = this.formBean.platform + this.formBean.system\r\n        params.serverIds = params.serverId.toString()\r\n        params.timeWinds = this.formBean.timeWindowS + '-' + this.formBean.timeWindowE\r\n        delete params.timeWindowS\r\n        delete params.timeWindowE\r\n        let httpConfig = {\r\n          url: RESOURCE_PATH,\r\n          data: params\r\n        }\r\n        if (this.transData.id) {\r\n          httpConfig.method = 'POST'\r\n          httpConfig.url = RESOURCE_PATH + '/update'\r\n        } else {\r\n          httpConfig.method = 'PUT'\r\n          httpConfig.url = RESOURCE_PATH + '/add'\r\n        }\r\n        this.$ajax(httpConfig)\r\n          .then(resp => {\r\n            this.saveLoding = false\r\n            this.cancel()\r\n          })\r\n      })\r\n    },\r\n    queryLimitType () {\r\n      this.limitTypeData = []\r\n      let params = { dicCode: 'limitType' }\r\n      const loadConfig = {\r\n        method: 'GET',\r\n        url: '/mDictionary/selectDicCode',\r\n        params: params\r\n      }\r\n      this.$ajax(loadConfig)\r\n        .then(resp => {\r\n          if (resp.data) {\r\n            resp.data.forEach(data1 => {\r\n              let temp = {}\r\n              temp.key = data1.dicValue\r\n              temp.value = parseInt(data1.dicKey)\r\n              temp.label = data1.dicValue\r\n              this.limitTypeData.push(temp)\r\n            })\r\n          }\r\n        })\r\n    },\r\n    /**\r\n\t\t * 返回到数据视图\r\n\t\t **/\r\n    cancel () {\r\n      // this.$emit('switch');\r\n      // let backParam = {id: this.transData.id, statusName: \"weightLimitTable\"};\r\n      let queryCache = { formBean: this.transData.formBean, currentPage: this.transData.currentPage, pageSize: this.transData.pageSize }\r\n      this.$emit('switch', Object.assign({}, queryCache))\r\n    },\r\n    getServerList () {\r\n      let serverConfig = {\r\n        method: 'GET',\r\n        url: '/udsServer/listQuery'\r\n      }\r\n      this.$ajax(serverConfig)\r\n        .then(resp => {\r\n          this.serverData = [{ 'id': '*', 'serverName': '*' }]\r\n          if (resp.status && resp.status === 200) {\r\n            resp.data.forEach(e => {\r\n              let tmp = {}\r\n              tmp.id = e.id + ''\r\n              tmp.serverName = e.serverName\r\n              this.serverData.push(tmp)\r\n            })\r\n          }\r\n        })\r\n    }\r\n  },\r\n  /**\r\n\t * 视图挂载\r\n\t **/\r\n  mounted () {\r\n    this.getServerList()\r\n    this.queryLimitType()\r\n    this.init()\r\n  }\r\n}\r\n\r\n",{"version":3,"sources":["Form.vue"],"names":[],"mappings":";AAiFA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Form.vue","sourceRoot":"src/view/spdb/systemsetting/weightType","sourcesContent":["<template>\r\n\t<div>\r\n\t\t<Form ref=\"udsjobweightlimitForm\" :model=\"formBean\" :label-width=\"100\" :rules=\"formRule\">\r\n\t\t\t<Row>\r\n\t\t\t\t<Col span=\"6\">\r\n\t\t\t\t\t<FormItem prop=\"limitType\" label=\"类型\">\r\n\t\t\t\t\t\t<Select v-model=\"formBean.limitType\" :disabled=\"disabledStatus\" filterable  clearable>\r\n\t\t\t\t\t\t\t<Option v-for=\"item in limitTypeData\" :value=\"item.value\" :key=\"item.key\">{{ item.label }}</Option>\r\n\t\t\t\t\t\t</Select>\r\n\t\t\t\t\t</FormItem>\r\n\t\t\t\t</Col>\r\n\t\t\t</Row>\r\n\t\t\t<Row>\r\n\t\t\t\t<Col span=\"6\">\r\n\t\t\t\t\t<FormItem prop=\"limitValue\" label=\"上限\">\r\n\t\t\t\t\t\t<InputNumber  v-model=\"formBean.limitValue\" :max=\"999\" :min=\"0\" style=\"width:100%\"/>\r\n\t\t\t\t\t</FormItem>\r\n\t\t\t\t</Col>\r\n\t\t\t</Row>\r\n      <Row>\r\n\t\t\t\t<Col span=\"6\">\r\n\t\t\t\t\t<FormItem prop=\"serverId\" label=\"机器\">\r\n            <Select v-model=\"formBean.serverId\" multiple clearable>\r\n\t\t\t\t\t\t\t<Option v-for=\"item in serverData\" :value=\"item.id\" :key=\"item.id\">{{ item.serverName }}</Option>\r\n\t\t\t\t\t\t</Select>\r\n\t\t\t\t\t\t<!-- <Input  v-model=\"formBean.serverId\" style=\"width:100%\"/> -->\r\n\t\t\t\t\t</FormItem>\r\n\t\t\t\t</Col>\r\n\t\t\t</Row>\r\n      <Row>\r\n\t\t\t\t<Col span=\"6\">\r\n\t\t\t\t\t<FormItem prop=\"timeWindow\" label=\"时间窗口\">\r\n            <TimePicker\r\n              v-model=\"formBean.timeWindowS\"\r\n              format=\"HH:mm\"\r\n              placeholder=\"开始时间\"\r\n              style=\"width:50%\"\r\n            ></TimePicker>\r\n            <TimePicker\r\n                v-model=\"formBean.timeWindowE\"\r\n                format=\"HH:mm\"\r\n                placeholder=\"结束时间\"\r\n                style=\"width:50%\"\r\n              ></TimePicker>\r\n\t\t\t\t\t\t<!-- <Input  v-model=\"formBean.timeWindow\" style=\"width:100%\"/> -->\r\n\t\t\t\t\t</FormItem>\r\n\t\t\t\t</Col>\r\n        <!-- <Col span=\"12\">\r\n        <FormItem>\r\n          <TimePicker\r\n                :value=\"formBean.timeWindow\"\r\n                format=\"HH:mm\"\r\n                placeholder=\"请选择\"\r\n              ></TimePicker>\r\n        </FormItem>\r\n        </Col> -->\r\n\t\t\t</Row>\r\n\t\t\t<!-- <Row>\r\n\t\t\t\t<Col span=\"6\">\r\n\t\t\t\t\t<FormItem prop=\"presentValue\" label=\"当前数值\">\r\n\t\t\t\t\t\t<InputNumber  v-model=\"formBean.presentValue\" style=\"width:100%\"/>\r\n\t\t\t\t\t</FormItem>\r\n\t\t\t\t</Col>\r\n\t\t\t</Row> -->\r\n\t\t\t<Row>\r\n\t\t\t\t<Col span=\"6\">\r\n\t\t\t\t\t<FormItem prop=\"des\" label=\"描述\">\r\n\t\t\t\t\t\t<Input v-model=\"formBean.des\"/>\r\n\t\t\t\t\t</FormItem>\r\n\t\t\t\t</Col>\r\n\t\t\t</Row>\r\n\t\t</Form>\r\n\r\n\t\t<div>\r\n\t\t\t<Button type=\"primary\" icon=\"md-add\" :loading=\"saveLoding\" @click=\"save\">保存</Button>\r\n\t\t\t<Button type=\"primary\" icon=\"ios-trash-outline\" @click=\"cancel\">取消</Button>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\nconst RESOURCE_PATH = '/udsJobWeightLimit'\r\n\r\nexport default {\r\n  props: {\r\n    transData: {\r\n      type: Object,\r\n      default: function () {\r\n    \t\t\treturn {}\r\n      }\r\n    }\r\n  \t},\r\n  data () {\r\n    const validateTimeWindow = (rule, value, callback) => {\r\n      if (!this.formBean.timeWindowS || !this.formBean.timeWindowE) {\r\n        return callback(new Error('请选择时间'))\r\n      } else {\r\n        return callback()\r\n      }\r\n    }\r\n    return {\r\n      serverData: [],\r\n      limitTypeData: [],\r\n      formBean: {},\r\n      saveLoding: false,\r\n      disabledStatus: false,\r\n      formRule: {\r\n        limitType: [{\r\n          required: true,\r\n          message: '请输入数据！'\r\n        }],\r\n        limitValue: [{\r\n          required: true,\r\n          type: 'number',\r\n          message: '请输入数据！'\r\n        }],\r\n        serverId: [{\r\n          required: true,\r\n          message: '请选择机器！'\r\n        }],\r\n        timeWindow: [{\r\n          validator: validateTimeWindow, trigger: 'blur'\r\n        }]\r\n        // presentValue: [{\r\n        //   required: true,\r\n        //   message: '请输入数据！'\r\n        // }]\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    /**\r\n\t\t * 初始化\r\n\t\t **/\r\n    init () {\r\n      if (this.transData.id) { // 如果传过来的存在ID则说明是编辑功能跳转过来\r\n        this.disabledStatus = true\r\n        let loadConfig = {\r\n          method: 'GET',\r\n          url: RESOURCE_PATH + '/getDetail',\r\n          params: { id: this.transData.id }\r\n        }\r\n        this.$ajax(loadConfig)\r\n          .then(resp => {\r\n            let tmp = Object.assign({}, resp.data)\r\n            tmp.serverId = tmp.serverIds.split(',')\r\n            tmp.timeWindowS = tmp.timeWinds.split('-')[0]\r\n            tmp.timeWindowE = tmp.timeWinds.split('-')[1]\r\n            this.formBean = Object.assign({}, tmp)\r\n          })\r\n      } else {\r\n        this.bindData()\r\n      }\r\n    },\r\n    /**\r\n\t\t * 如果传过来的有初始数据则进行数据绑定\r\n\t\t **/\r\n    bindData () {\r\n      try {\r\n        this.formBean = Object.assign({}, this.transData.initFormBean)\r\n        this.formBean.limitValue = 1 // 设置初始值\r\n      } catch (error) {\r\n        console.error(error)\r\n      }\r\n    },\r\n    /**\r\n\t\t * 保存表单\r\n\t\t **/\r\n    save () {\r\n      this.saveLoding = true\r\n      this.$refs.udsjobweightlimitForm.validate(valid => {\r\n        if (!valid) {\r\n          this.saveLoding = false\r\n          return\r\n        }\r\n        let params = {}\r\n        Object.assign(params, this.formBean)\r\n        params.authps = this.formBean.platform + this.formBean.system\r\n        params.serverIds = params.serverId.toString()\r\n        params.timeWinds = this.formBean.timeWindowS + '-' + this.formBean.timeWindowE\r\n        delete params.timeWindowS\r\n        delete params.timeWindowE\r\n        let httpConfig = {\r\n          url: RESOURCE_PATH,\r\n          data: params\r\n        }\r\n        if (this.transData.id) {\r\n          httpConfig.method = 'POST'\r\n          httpConfig.url = RESOURCE_PATH + '/update'\r\n        } else {\r\n          httpConfig.method = 'PUT'\r\n          httpConfig.url = RESOURCE_PATH + '/add'\r\n        }\r\n        this.$ajax(httpConfig)\r\n          .then(resp => {\r\n            this.saveLoding = false\r\n            this.cancel()\r\n          })\r\n      })\r\n    },\r\n    queryLimitType () {\r\n      this.limitTypeData = []\r\n      let params = { dicCode: 'limitType' }\r\n      const loadConfig = {\r\n        method: 'GET',\r\n        url: '/mDictionary/selectDicCode',\r\n        params: params\r\n      }\r\n      this.$ajax(loadConfig)\r\n        .then(resp => {\r\n          if (resp.data) {\r\n            resp.data.forEach(data1 => {\r\n              let temp = {}\r\n              temp.key = data1.dicValue\r\n              temp.value = parseInt(data1.dicKey)\r\n              temp.label = data1.dicValue\r\n              this.limitTypeData.push(temp)\r\n            })\r\n          }\r\n        })\r\n    },\r\n    /**\r\n\t\t * 返回到数据视图\r\n\t\t **/\r\n    cancel () {\r\n      // this.$emit('switch');\r\n      // let backParam = {id: this.transData.id, statusName: \"weightLimitTable\"};\r\n      let queryCache = { formBean: this.transData.formBean, currentPage: this.transData.currentPage, pageSize: this.transData.pageSize }\r\n      this.$emit('switch', Object.assign({}, queryCache))\r\n    },\r\n    getServerList () {\r\n      let serverConfig = {\r\n        method: 'GET',\r\n        url: '/udsServer/listQuery'\r\n      }\r\n      this.$ajax(serverConfig)\r\n        .then(resp => {\r\n          this.serverData = [{ 'id': '*', 'serverName': '*' }]\r\n          if (resp.status && resp.status === 200) {\r\n            resp.data.forEach(e => {\r\n              let tmp = {}\r\n              tmp.id = e.id + ''\r\n              tmp.serverName = e.serverName\r\n              this.serverData.push(tmp)\r\n            })\r\n          }\r\n        })\r\n    }\r\n  },\r\n  /**\r\n\t * 视图挂载\r\n\t **/\r\n  mounted () {\r\n    this.getServerList()\r\n    this.queryLimitType()\r\n    this.init()\r\n  }\r\n}\r\n\r\n</script>\r\n"]}]}