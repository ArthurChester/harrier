{"remainingRequest":"D:\\WorkSpace\\IdeaProjects\\harrier\\harrier-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\WorkSpace\\IdeaProjects\\harrier\\harrier-ui\\src\\view\\login\\login.vue?vue&type=style&index=0&id=77c14c32&lang=less&scoped=true&","dependencies":[{"path":"D:\\WorkSpace\\IdeaProjects\\harrier\\harrier-ui\\src\\view\\login\\login.vue","mtime":1681468306523},{"path":"D:\\WorkSpace\\IdeaProjects\\harrier\\harrier-ui\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"D:\\WorkSpace\\IdeaProjects\\harrier\\harrier-ui\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\WorkSpace\\IdeaProjects\\harrier\\harrier-ui\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\WorkSpace\\IdeaProjects\\harrier\\harrier-ui\\node_modules\\less-loader\\dist\\cjs.js","mtime":1695117006756},{"path":"D:\\WorkSpace\\IdeaProjects\\harrier\\harrier-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\WorkSpace\\IdeaProjects\\harrier\\harrier-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\r\n@import url(\"./login.less\");\r\n.sys-bar-title {\r\n  color: #fff;\r\n  width: 600px;\r\n  position: absolute;\r\n  // top: 8px;\r\n  // left: 200px;\r\n  left: 60px;\r\n  z-index: 999;\r\n  height: 60px;\r\n  text-align: left;\r\n  line-height: 54px;\r\n  margin: 0 0px;\r\n  font-size: 24px;\r\n  letter-spacing: 0.1em;\r\n\r\n  background-repeat: no-repeat;\r\n}\r\n.ivu-btn-primary{\r\n  background-color: #376eff;\r\n  border-color: #376eff;\r\n  margin-top: 3%;\r\n}\r\n.flip-horizontal {\r\n  width: 90%;\r\n}\r\n.loginTitle {\r\n  font-family: FZLTZHUNHJW--GB1-0;\r\n  font-size: 35px;\r\n  color: #0B1131;\r\n  letter-spacing: 0;\r\n  font-weight: 500;\r\n}\r\n.homeTitle {\r\n  font-family: FZLTCHJW--GB1-0;\r\n  font-size: 45px;\r\n  color: #0B1131;\r\n  letter-spacing: 0;\r\n  text-align: center;\r\n  font-weight: 550;\r\n}\r\n.loginButten {\r\n  background-image: linear-gradient(270deg, #6132fe  0%, #3b54f9 100%);\r\n}\r\n",{"version":3,"sources":["login.vue"],"names":[],"mappings":";AAuNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"login.vue","sourceRoot":"src/view/login","sourcesContent":["<template>\r\n<div id=\"login-header\" class=\"note\">\r\n  <div class=\"sys-bar-logo\">\r\n      <Row class=\"sys-bar-logo-row\">\r\n        <Col offset=\"4\" span=\"12\">\r\n        </Col>\r\n      </Row>\r\n    </div>\r\n\r\n    <Row style=\"height:100%;\">\r\n      <Col span=\"15\">\r\n          &nbsp;\r\n      </Col>\r\n      <Col span=\"9\" style=\"height:100%;opacity: 0.76;background: #FFFFFF;\">\r\n        <div style=\"text-align:center;padding-top:25%\">\r\n            <img src=\"../../../static/img/logo_harrier.png\" width = \"137px\" height = \"157px\"/>\r\n            <div class=\"homeTitle\">\r\n              {{ homeTitle }}\r\n            </div>\r\n        </div>\r\n        <Card :bordered=\"false\" :shadow=\"false\" :dis-hover=\"true\" class=\"login\">\r\n           <div class=\"form-con\">\r\n              <login-form ref=\"loginForm\" @on-success-valid=\"handleSubmit\" :captchaSwitch=\"captchaSwitch\"></login-form>\r\n           </div>\r\n           <div style=\"margin-top:3%;margin-bottom:10%\">\r\n              <Button type=\"text\" size=\"small\" style=\"float:left;color: #0B1131;font-size:16px\" @click=\"register()\">注册</Button>\r\n              <Button type=\"text\" size=\"small\" style=\"float:right;color: #0B1131;font-size:16px\" @click=\"resetPasswords()\">忘记密码</Button>\r\n           </div> \r\n              <!-- <Form ref=\"loginForm\" :model=\"formBean\" :rules=\"formRule\">\r\n                <FormItem>\r\n                </FormItem>\r\n                 <FormItem prop=\"username\">\r\n                    <Input type=\"text\" size=\"large\" v-model=\"formBean.username\" icon=\"ios-person\" placeholder=\"请输入用户名\" ></Input>\r\n                </FormItem>\r\n                <FormItem prop=\"password\">\r\n                  <Input type=\"password\" size=\"large\" v-model=\"formBean.password\" icon=\"ios-lock\" placeholder=\"请输入密码\" >\r\n                  </Input>\r\n                </FormItem>\r\n              </Form>\r\n              <Button id=\"loginBtn\" class=\"loginButten\" :disabled=\"isClick\" :long=\"true\" @click=\"submit()\" type=\"primary\">{{login}}</Button>\r\n              <div style=\"margin-top:3%;margin-bottom:10%\">\r\n                <Button type=\"text\" size=\"small\" style=\"float:left;color: #0B1131;font-size:16px\" @click=\"register()\">注册</Button>\r\n                <Button type=\"text\" size=\"small\" style=\"float:right;color: #0B1131;font-size:16px\" @click=\"resetPasswords()\">忘记密码</Button>\r\n              </div> -->\r\n            </Card>\r\n      </Col>\r\n    </Row>\r\n</div>\r\n</template>\r\n\r\n<script>\r\nimport LoginForm from '_c/login-form'\r\nimport { mapActions } from 'vuex'\r\nimport Main from '@/components/main'\r\nimport utils from '@/common/utils'\r\nimport { localRemove } from '@/libs/util'\r\nimport router, { createRouter } from '@/router'\r\nimport routers from '@/router/routers'\r\n// import axios from 'axios'\r\nexport default {\r\n  data () {\r\n    return {\r\n      formRule: {\r\n        username: [{ required: true, message: '请输入用户名！' }],\r\n        password: [{ required: true, message: '请输入密码！' }]\r\n      },\r\n      note: {\r\n        backgroundImage: \"url('static/img/header.jpg')\",\r\n        backgroundRepeat: 'no-repeat'\r\n        // backgroundSize:\"25px auto\",\r\n        // marginTop: \"5px\",\r\n      },\r\n      cardStyle: 'height:280px;margin-top:30%',\r\n      captchaSwitch: false,\r\n      homeTitle: '大数据中心批量监控系统',\r\n      formBean: {},\r\n      login: '登录',\r\n      userPlatform: new Set(),\r\n      userSystem: {}\r\n    }\r\n  },\r\n  components: {\r\n    LoginForm\r\n  },\r\n  created () {\r\n    this.getCaptchaSwitch()\r\n  },\r\n  methods: {\r\n    ...mapActions([\r\n      'handleLogin',\r\n      'getUserInfo'\r\n    ]),\r\n    getCaptchaSwitch () {\r\n      let loadConfig = {\r\n        method: 'GET',\r\n        url: '/login/selectCaptchaOnOff'\r\n      }\r\n      this.$ajax(loadConfig)\r\n        .then(resp => {\r\n          this.captchaSwitch = resp.data.data\r\n          if (this.captchaSwitch) {\r\n            this.cardStyle = 'height:320px;margin-top:25%;'\r\n          }\r\n        })\r\n    },\r\n    handleSubmit ({ userName, password, code, uuid }) {\r\n      let params = {}\r\n      params.username = userName\r\n      params.password = password\r\n      params.code = code\r\n      params.uuid = uuid\r\n      let httpConfig = {\r\n        method: 'POST',\r\n        url: '/login',\r\n        params: params\r\n      }\r\n      this.$ajax(httpConfig).then(async resp => {\r\n        let req = resp.data\r\n        if (!req.success) {\r\n          this.$Modal.error({\r\n            title: '提示',\r\n            content: req.msg\r\n          })\r\n          if (this.captchaSwitch) {\r\n            this.$refs.loginForm.getCode()\r\n            this.captchaSwitch = true\r\n          }\r\n          return\r\n        }\r\n        this.$store.dispatch('setUserToken', req.data)\r\n        await this.getUser(userName)\r\n        localRemove('route')\r\n        router.matcher = createRouter(routers).matcher\r\n        this.$router.push({\r\n          name: this.$config.homeName\r\n        })\r\n      })\r\n    },\r\n    async getUser (usercode) {\r\n      let params = {}\r\n      params.usercode = usercode\r\n\r\n      let httpConfig = {\r\n        method: 'GET',\r\n        url: '/user/loadByUserCode',\r\n        params: params\r\n      }\r\n      await this.$ajax(httpConfig).then(resp => {\r\n        let req = resp.data\r\n        if (!req) {\r\n          return\r\n        }\r\n        this.$store.dispatch('setUserInfo', req)\r\n        utils.getUserPlatform(req.userId)\r\n      })\r\n    },\r\n    async getUserPlatform (userId) {\r\n      const httpConfig = {\r\n        method: 'GET',\r\n        url: `/user/${userId}/platform/permiss`\r\n      }\r\n      await this.$ajax(httpConfig)\r\n        .then(async resp => {\r\n          if (resp.data) {\r\n            for (const permiss of resp.data) {\r\n            // resp.data.forEach(async permiss => {\r\n              this.userPlatform.add(permiss.platform)\r\n              let temp = new Set()\r\n              if (this.userSystem[permiss.platform]) {\r\n                temp = this.userSystem[permiss.platform]\r\n              }\r\n              if (permiss.systems === '*') {\r\n                const systemConfig = {\r\n                  method: 'GET',\r\n                  url: '/udsSystem/selectSystem',\r\n                  params: { platform: permiss.platform }\r\n                }\r\n                await this.$ajax(systemConfig)\r\n                  .then(resp => {\r\n                    resp.data.forEach(data => {\r\n                      if (permiss.platform === data.platform && data.systems !== '*') {\r\n                        temp.add(data.systems)\r\n                      }\r\n                    })\r\n                  })\r\n              } else {\r\n                temp.add(permiss.systems)\r\n              }\r\n              this.userSystem[permiss.platform] = temp\r\n            }\r\n          }\r\n          this.userPlatform.forEach(data => {\r\n            let temp = this.userSystem[data]\r\n            if (temp) {\r\n              this.userSystem[data] = Array.from(temp)\r\n            }\r\n          })\r\n          const data = {\r\n            userPlatform: Array.from(this.userPlatform),\r\n            userSystem: this.userSystem\r\n          }\r\n          this.$store.dispatch('setUserSystem', data)\r\n        })\r\n    },\r\n    register () {\r\n      this.$router.push({ path: '/register' })\r\n    },\r\n    resetPasswords () {\r\n      this.$router.push({ path: '/resetPasswords' })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n@import url(\"./login.less\");\r\n.sys-bar-title {\r\n  color: #fff;\r\n  width: 600px;\r\n  position: absolute;\r\n  // top: 8px;\r\n  // left: 200px;\r\n  left: 60px;\r\n  z-index: 999;\r\n  height: 60px;\r\n  text-align: left;\r\n  line-height: 54px;\r\n  margin: 0 0px;\r\n  font-size: 24px;\r\n  letter-spacing: 0.1em;\r\n\r\n  background-repeat: no-repeat;\r\n}\r\n.ivu-btn-primary{\r\n  background-color: #376eff;\r\n  border-color: #376eff;\r\n  margin-top: 3%;\r\n}\r\n.flip-horizontal {\r\n  width: 90%;\r\n}\r\n.loginTitle {\r\n  font-family: FZLTZHUNHJW--GB1-0;\r\n  font-size: 35px;\r\n  color: #0B1131;\r\n  letter-spacing: 0;\r\n  font-weight: 500;\r\n}\r\n.homeTitle {\r\n  font-family: FZLTCHJW--GB1-0;\r\n  font-size: 45px;\r\n  color: #0B1131;\r\n  letter-spacing: 0;\r\n  text-align: center;\r\n  font-weight: 550;\r\n}\r\n.loginButten {\r\n  background-image: linear-gradient(270deg, #6132fe  0%, #3b54f9 100%);\r\n}\r\n</style>\r\n"]}]}