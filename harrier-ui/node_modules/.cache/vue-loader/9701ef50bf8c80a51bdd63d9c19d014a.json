{"remainingRequest":"D:\\WorkSpace\\IdeaProjects\\harrier\\harrier-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\WorkSpace\\IdeaProjects\\harrier\\harrier-ui\\src\\view\\spdb\\job\\jobList\\Killjob.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\WorkSpace\\IdeaProjects\\harrier\\harrier-ui\\src\\view\\spdb\\job\\jobList\\Killjob.vue","mtime":1681468306537},{"path":"D:\\WorkSpace\\IdeaProjects\\harrier\\harrier-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\WorkSpace\\IdeaProjects\\harrier\\harrier-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"D:\\WorkSpace\\IdeaProjects\\harrier\\harrier-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\WorkSpace\\IdeaProjects\\harrier\\harrier-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\r\nimport utils from '@/common/utils'\r\n\r\nconst RESOURCE_PATH = '/mkill'\r\n\r\nexport default {\r\n  props: {\r\n    transData: {\r\n      type: Object,\r\n      default: function () {\r\n    \t\t\treturn {}\r\n      }\r\n    }\r\n  \t},\r\n  data () {\r\n    return {\r\n      formBean: {},\r\n      showApplicationId: false,\r\n      bdisabled: false,\r\n      paramDisable: false,\r\n      confirm: {\r\n        show: false\r\n      },\r\n      tipData: [],\r\n      jobTypeData: [],\r\n      gridData: [],\r\n      page: {\r\n        current: 1,\r\n        total: 10,\r\n        size: 10,\r\n        opt: [10, 50, 100]\r\n      },\r\n      formRule: {\r\n        jobType: [{\r\n          required: true,\r\n          message: '请输入数据！'\r\n        }],\r\n        param: [{\r\n          validator: (rule, value, callback, source, options) => {\r\n            if ((this.formBean.jobType == 'Hive' || this.formBean.jobType == 'Other') && (this.formBean.param == '' || this.formBean.param == null)) {\r\n              callback(new Error('请输入数据！'))\r\n            } else {\r\n              return callback()\r\n            }\r\n          },\r\n          trigger: 'blur'\r\n        }]\r\n      },\r\n      gridColumns: [\r\n        {\r\n          title: '平台名',\r\n          key: 'platform',\r\n          width: 90\r\n        },\r\n        {\r\n          title: '应用名',\r\n          key: 'system',\r\n          width: 90\r\n        },\r\n        {\r\n          title: '作业名',\r\n          key: 'job'\r\n        },\r\n        {\r\n          title: '参数',\r\n          key: 'param'\r\n        },\r\n        {\r\n          title: '作业类型',\r\n          key: 'jobType',\r\n          width: 120\r\n        },\r\n        {\r\n          title: '用户',\r\n          key: 'userName',\r\n          width: 100\r\n        },\r\n        {\r\n          title: '操作时间',\r\n          key: 'operateTime',\r\n          width: 175\r\n        },\r\n        {\r\n          title: '状态',\r\n          key: 'status',\r\n          width: 80\r\n        },\r\n        {\r\n          title: '日志信息',\r\n          width: 100,\r\n          render: (h, { column, index, row }) => {\r\n            return h('div', [\r\n              h('Button', {\r\n                props: {\r\n                  size: 'small',\r\n                  type: 'info'\r\n                },\r\n                style: {\r\n                  marginRight: '5px'\r\n                },\r\n                on: {\r\n                  click: () => {\r\n                    let params = {}\r\n                    this.formBean.operateLog = row.operateLog\r\n \t\t\t\t\t\t\t\t\t\tObject.assign(params, this.formBean)\r\n                    params.check = '1'\r\n                    params.type = 'excel'\r\n                    let loadConfig = {\r\n                      method: 'GET',\r\n                      url: RESOURCE_PATH + '/logdownload',\r\n                      params: params\r\n                    }\r\n                    this.$ajax(loadConfig)\r\n                      .then(resp => {\r\n                        if (resp.data.returnCode && resp.data.returnCode == 'fail') {\r\n                          this.$Message.warning({\r\n                            content: '日志不存在!',\r\n                            duration: 5,\r\n                            closable: true\r\n                          })\r\n                        } else {\r\n                          params.check = '0'\r\n                          utils.download(RESOURCE_PATH + '/logdownload', params)\r\n                        }\r\n                      })\r\n                  }\r\n                }\r\n              }, '下载')\r\n            ])\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  },\r\n  methods: {\r\n    /**\r\n\t\t * 初始化\r\n\t\t **/\r\n    init () {\r\n      this.bindData()\r\n      this.search()\r\n    },\r\n    queryTipList () {\r\n      let loadConfig = {\r\n        method: 'GET',\r\n        url: '/dictionary',\r\n        params: { dicCode: 'm_kill_tip' }\r\n      }\r\n      this.$ajax(loadConfig)\r\n        .then(resp => {\r\n          resp.data.rows.forEach(data => {\r\n            let tmp = {}\r\n            tmp.value = data.dicValue\r\n            tmp.label = data.dicName\r\n            // this.formBean.tip=data.dicValue;\r\n            this.tipData.push(tmp)\r\n          })\r\n        })\r\n    },\r\n    queryJobTypeList () {\r\n      let loadConfig = {\r\n        method: 'GET',\r\n        url: '/dictionary',\r\n        params: { dicCode: 'm_kill_jobtype' }\r\n      }\r\n      this.$ajax(loadConfig)\r\n        .then(resp => {\r\n          // this.jobTypeData = [];\r\n          resp.data.rows.forEach(data => {\r\n            let tmp = {}\r\n            tmp.value = data.dicValue\r\n            tmp.label = data.dicName\r\n            this.jobTypeData.push(tmp)\r\n          })\r\n        })\r\n    },\r\n    /**\r\n\t\t * 如果传过来的有初始数据则进行数据绑定\r\n\t\t **/\r\n    bindData () {\r\n      try {\r\n        // this.formBean = Object.assign({}, this.transData.jobData);\r\n        this.formBean.platform = this.transData.jobData.platform\r\n        this.formBean.system = this.transData.jobData.system\r\n        this.formBean.job = this.transData.jobData.job\r\n        if(this.transData.jobData.isComplement){\r\n          this.formBean.jobId = this.transData.jobData.id\r\n          this.formBean.isComplement = this.transData.jobData.isComplement\r\n        }\r\n      } catch (error) {\r\n        console.error(error)\r\n      }\r\n    },\r\n    jobTypeChange () {\r\n      if (this.formBean.jobType) {\r\n        this.showApplicationId = true\r\n      } else {\r\n        this.showApplicationId = false\r\n      }\r\n\r\n      if (this.formBean.jobType == 'Hive' || this.formBean.jobType == 'Other') {\r\n        this.paramDisable = false\r\n      } else {\r\n        this.paramDisable = true\r\n      }\r\n\r\n      this.tipData.forEach(data => {\r\n        if (this.formBean.jobType == data.label) {\r\n          this.formBean.tip = data.value\r\n        }\r\n      })\r\n    },\r\n    jobkill () {\r\n      this.$refs.mkillForm.validate(valid => {\r\n        if (!valid) return\r\n        this.confirm.show = true\r\n        this.confirm.job = this.formBean.job\r\n        this.confirm.jobType = this.formBean.jobType\r\n        this.confirm.param = this.formBean.param\r\n      })\r\n    },\r\n    confirmCancel () {\r\n      this.confirm.show = false\r\n    },\r\n    /**\r\n\t\t * 保存表单\r\n\t\t **/\r\n    save () {\r\n      this.confirm.show = false\r\n      let params = {}\r\n      Object.assign(params, this.formBean)\r\n      params.authps = this.formBean.platform + this.formBean.system\r\n      let httpConfig = {\r\n        url: RESOURCE_PATH,\r\n        data: params,\r\n        method: 'POST'\r\n      }\r\n      this.bdisabled = true\r\n      this.$ajax(httpConfig)\r\n        .then(resp => {\r\n          this.bdisabled = false\r\n          this.search()\r\n        })\r\n    },\r\n    /**\r\n\t\t * 返回到数据视图\r\n\t\t **/\r\n    cancel () {\r\n      let prevTab = ''\r\n      if (this.transData.tabObj) {\r\n        prevTab = this.transData.tabObj.prevTab\r\n      } else if (this.transData.prevTab) {\r\n        prevTab = this.transData.prevTab\r\n      }\r\n      let queryCache = { formBean: this.transData.formBean, currentPage: this.transData.currentPage, pageSize: this.transData.pageSize }\r\n      let backParam = { id: this.transData.previd, statusName: 'table', prevTab: prevTab, type: 'back', curTab: 'jobdetail' }\r\n      if (this.transData.jobStatus) {\r\n        queryCache.jobStatus = this.transData.jobStatus\r\n      }\r\n      if (this.transData.jobData) {\r\n        this.$emit('switch', Object.assign({}, queryCache, backParam, { prequeryCache: this.transData.queryCache }, { jobData: this.transData.jobData }))\r\n      } else {\r\n        this.$emit('switch', Object.assign({}, queryCache, backParam))\r\n      }\r\n    },\r\n    /**\r\n\t\t * 改变页码事件\r\n\t\t **/\r\n    changePage (currentPage) {\r\n      this.page.current = currentPage\r\n      this.search()\r\n    },\r\n    /**\r\n\t\t * 改变分页大小事件\r\n\t\t **/\r\n    changePageSize (pageSize) {\r\n      this.page.size = pageSize\r\n      this.search()\r\n    },\r\n\t\t    /**\r\n\t\t * 查询\r\n\t\t **/\r\n    search () {\r\n      let params = {}\r\n      params.currentPage = this.page.current\r\n      params.pageSize = this.page.size\r\n      params.job = this.formBean.job\r\n      params.platform = this.formBean.platform\r\n      params.system = this.formBean.system\r\n      let httpConfig = {\r\n        method: 'GET',\r\n        url: RESOURCE_PATH,\r\n        params: params\r\n      }\r\n\r\n      this.$ajax(httpConfig)\r\n        .then(resp => {\r\n          this.gridData = resp.data.rows\r\n          this.page.total = resp.data.total\r\n        })\r\n    }\r\n  },\r\n\r\n  /**\r\n\t * 视图挂载\r\n\t **/\r\n  mounted () {\r\n    this.queryJobTypeList()\r\n    this.queryTipList()\r\n    this.init()\r\n  }\r\n}\r\n\r\n",{"version":3,"sources":["Killjob.vue"],"names":[],"mappings":";AA2EA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Killjob.vue","sourceRoot":"src/view/spdb/job/jobList","sourcesContent":["<template>\r\n\t<div>\r\n\t\t<Form ref=\"mkillForm\" :model=\"formBean\" :label-width=\"70\" :rules=\"formRule\">\r\n\t\t\t<Row>\r\n\t\t\t\t<Col span=\"3\">\r\n\t\t\t\t\t<FormItem prop=\"platform\" label=\"平台名\">\r\n\t\t\t\t\t\t<Input readonly v-model=\"formBean.platform\"/>\r\n\t\t\t\t\t</FormItem>\r\n\t\t\t\t</Col>\r\n\t\t\t\t<Col span=\"3\">\r\n\t\t\t\t\t<FormItem prop=\"system\" label=\"应用名\">\r\n\t\t\t\t\t\t<Input readonly v-model=\"formBean.system\"/>\r\n\t\t\t\t\t</FormItem>\r\n\t\t\t\t</Col>\r\n\t\t\t\t<Col span=\"6\">\r\n\t\t\t\t\t<FormItem prop=\"job\" label=\"作业名\">\r\n\t\t\t\t\t\t<Input readonly v-model=\"formBean.job\"/>\r\n\t\t\t\t\t</FormItem>\r\n\t\t\t\t</Col>\r\n\t\t\t\t<Col span=\"3\">\r\n\t\t\t\t\t<FormItem prop=\"jobType\" label=\"kill类型\">\r\n\t\t\t\t\t\t<Select v-model=\"formBean.jobType\" filterable clearable @on-change=\"jobTypeChange\">\r\n\t\t\t\t\t\t\t<Option v-for=\"item in jobTypeData\" :value=\"item.value\" :key=\"item.key\">{{ item.label }}</Option>\r\n\t\t\t\t\t\t</Select>\r\n\t\t\t\t\t</FormItem>\r\n\t\t\t\t</Col>\r\n\t\t\t\t<Col span=\"4\">\r\n\t\t\t\t\t<FormItem prop=\"param\" label=\"参数\">\r\n\t\t\t\t\t\t<Input v-model=\"formBean.param\" placeholder=\"请输入参数\" :disabled=\"paramDisable\"/>\r\n\t\t\t\t\t</FormItem>\r\n\t\t\t\t</Col>\r\n\t\t\t\t<Col span=\"5\" v-if=\"showApplicationId\">\r\n\t\t\t\t\t\t<p style=\"color:red;font-size:12px;height:32px;line-height:32px\" >*提示:{{formBean.tip}}</p>\r\n\t\t\t\t</Col>\r\n\t\t\t</Row>\r\n\r\n\t\t\t<Row>\r\n\t\t\t\t<Col span=\"5\">\r\n\t\t\t\t \t<Button type=\"primary\" icon=\"md-add\" :disabled=\"bdisabled\" @click=\"jobkill\">Kill</Button>\r\n\t\t\t\t\t<Button type=\"primary\" icon=\"ios-arrow-back\" :disabled=\"bdisabled\" @click=\"cancel\" style=\"\">返回</Button>\r\n\t\t\t\t</Col>\r\n\t\t\t</Row>\r\n\r\n\t\t</Form>\r\n\r\n\t\t<Modal id=\"confirmM\"\r\n\t\t\tv-model=\"confirm.show\"\r\n\t\t\t:mask-closable=\"false\"\r\n\t\t\ttitle=\"提示\">\r\n\t\t\t<div>\r\n\t\t\t\t<Alert class=\"m-warn-con\" type=\"warning\" >确认kill作业:&#8195{{confirm.job}}</Alert>\r\n\t\t\t\t<Alert class=\"m-warn-con\" type=\"warning\" >&#8195作业类型:&#8195{{confirm.jobType}}</Alert>\r\n\t\t\t\t<Alert class=\"m-warn-con\" type=\"warning\" >&#8195&#8195&#8195参数:&#8195{{confirm.param}}</Alert>\r\n\t\t\t</div>\r\n\t\t\t<div slot=\"footer\">\r\n\t\t\t\t<div style=\"margin-left: 150px;\">\r\n\t\t\t\t\t<Button type=\"primary\" @click=\"save\">确定</Button>\r\n\t\t\t\t\t<Button type=\"primary\" @click=\"confirmCancel\">取消</Button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</Modal>\r\n\r\n\t\t<div class=\"spdb-table\">\r\n\t\t\t<Table :columns=\"gridColumns\" :data=\"gridData\" stripe >\r\n\t\t\t</Table>\r\n\t\t</div>\r\n\r\n\t\t<div class=\"spdb-page\">\r\n\t\t\t<Page placement=\"top\" :total=\"page.total\" :current=\"page.current\" :page-size=\"page.size\" :page-size-opts=\"page.opt\" show-total show-sizer show-elevat @on-change=\"changePage\" @on-page-size-change=\"changePageSize\"></Page>\r\n\t\t</div>\r\n\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\nimport utils from '@/common/utils'\r\n\r\nconst RESOURCE_PATH = '/mkill'\r\n\r\nexport default {\r\n  props: {\r\n    transData: {\r\n      type: Object,\r\n      default: function () {\r\n    \t\t\treturn {}\r\n      }\r\n    }\r\n  \t},\r\n  data () {\r\n    return {\r\n      formBean: {},\r\n      showApplicationId: false,\r\n      bdisabled: false,\r\n      paramDisable: false,\r\n      confirm: {\r\n        show: false\r\n      },\r\n      tipData: [],\r\n      jobTypeData: [],\r\n      gridData: [],\r\n      page: {\r\n        current: 1,\r\n        total: 10,\r\n        size: 10,\r\n        opt: [10, 50, 100]\r\n      },\r\n      formRule: {\r\n        jobType: [{\r\n          required: true,\r\n          message: '请输入数据！'\r\n        }],\r\n        param: [{\r\n          validator: (rule, value, callback, source, options) => {\r\n            if ((this.formBean.jobType == 'Hive' || this.formBean.jobType == 'Other') && (this.formBean.param == '' || this.formBean.param == null)) {\r\n              callback(new Error('请输入数据！'))\r\n            } else {\r\n              return callback()\r\n            }\r\n          },\r\n          trigger: 'blur'\r\n        }]\r\n      },\r\n      gridColumns: [\r\n        {\r\n          title: '平台名',\r\n          key: 'platform',\r\n          width: 90\r\n        },\r\n        {\r\n          title: '应用名',\r\n          key: 'system',\r\n          width: 90\r\n        },\r\n        {\r\n          title: '作业名',\r\n          key: 'job'\r\n        },\r\n        {\r\n          title: '参数',\r\n          key: 'param'\r\n        },\r\n        {\r\n          title: '作业类型',\r\n          key: 'jobType',\r\n          width: 120\r\n        },\r\n        {\r\n          title: '用户',\r\n          key: 'userName',\r\n          width: 100\r\n        },\r\n        {\r\n          title: '操作时间',\r\n          key: 'operateTime',\r\n          width: 175\r\n        },\r\n        {\r\n          title: '状态',\r\n          key: 'status',\r\n          width: 80\r\n        },\r\n        {\r\n          title: '日志信息',\r\n          width: 100,\r\n          render: (h, { column, index, row }) => {\r\n            return h('div', [\r\n              h('Button', {\r\n                props: {\r\n                  size: 'small',\r\n                  type: 'info'\r\n                },\r\n                style: {\r\n                  marginRight: '5px'\r\n                },\r\n                on: {\r\n                  click: () => {\r\n                    let params = {}\r\n                    this.formBean.operateLog = row.operateLog\r\n \t\t\t\t\t\t\t\t\t\tObject.assign(params, this.formBean)\r\n                    params.check = '1'\r\n                    params.type = 'excel'\r\n                    let loadConfig = {\r\n                      method: 'GET',\r\n                      url: RESOURCE_PATH + '/logdownload',\r\n                      params: params\r\n                    }\r\n                    this.$ajax(loadConfig)\r\n                      .then(resp => {\r\n                        if (resp.data.returnCode && resp.data.returnCode == 'fail') {\r\n                          this.$Message.warning({\r\n                            content: '日志不存在!',\r\n                            duration: 5,\r\n                            closable: true\r\n                          })\r\n                        } else {\r\n                          params.check = '0'\r\n                          utils.download(RESOURCE_PATH + '/logdownload', params)\r\n                        }\r\n                      })\r\n                  }\r\n                }\r\n              }, '下载')\r\n            ])\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  },\r\n  methods: {\r\n    /**\r\n\t\t * 初始化\r\n\t\t **/\r\n    init () {\r\n      this.bindData()\r\n      this.search()\r\n    },\r\n    queryTipList () {\r\n      let loadConfig = {\r\n        method: 'GET',\r\n        url: '/dictionary',\r\n        params: { dicCode: 'm_kill_tip' }\r\n      }\r\n      this.$ajax(loadConfig)\r\n        .then(resp => {\r\n          resp.data.rows.forEach(data => {\r\n            let tmp = {}\r\n            tmp.value = data.dicValue\r\n            tmp.label = data.dicName\r\n            // this.formBean.tip=data.dicValue;\r\n            this.tipData.push(tmp)\r\n          })\r\n        })\r\n    },\r\n    queryJobTypeList () {\r\n      let loadConfig = {\r\n        method: 'GET',\r\n        url: '/dictionary',\r\n        params: { dicCode: 'm_kill_jobtype' }\r\n      }\r\n      this.$ajax(loadConfig)\r\n        .then(resp => {\r\n          // this.jobTypeData = [];\r\n          resp.data.rows.forEach(data => {\r\n            let tmp = {}\r\n            tmp.value = data.dicValue\r\n            tmp.label = data.dicName\r\n            this.jobTypeData.push(tmp)\r\n          })\r\n        })\r\n    },\r\n    /**\r\n\t\t * 如果传过来的有初始数据则进行数据绑定\r\n\t\t **/\r\n    bindData () {\r\n      try {\r\n        // this.formBean = Object.assign({}, this.transData.jobData);\r\n        this.formBean.platform = this.transData.jobData.platform\r\n        this.formBean.system = this.transData.jobData.system\r\n        this.formBean.job = this.transData.jobData.job\r\n        if(this.transData.jobData.isComplement){\r\n          this.formBean.jobId = this.transData.jobData.id\r\n          this.formBean.isComplement = this.transData.jobData.isComplement\r\n        }\r\n      } catch (error) {\r\n        console.error(error)\r\n      }\r\n    },\r\n    jobTypeChange () {\r\n      if (this.formBean.jobType) {\r\n        this.showApplicationId = true\r\n      } else {\r\n        this.showApplicationId = false\r\n      }\r\n\r\n      if (this.formBean.jobType == 'Hive' || this.formBean.jobType == 'Other') {\r\n        this.paramDisable = false\r\n      } else {\r\n        this.paramDisable = true\r\n      }\r\n\r\n      this.tipData.forEach(data => {\r\n        if (this.formBean.jobType == data.label) {\r\n          this.formBean.tip = data.value\r\n        }\r\n      })\r\n    },\r\n    jobkill () {\r\n      this.$refs.mkillForm.validate(valid => {\r\n        if (!valid) return\r\n        this.confirm.show = true\r\n        this.confirm.job = this.formBean.job\r\n        this.confirm.jobType = this.formBean.jobType\r\n        this.confirm.param = this.formBean.param\r\n      })\r\n    },\r\n    confirmCancel () {\r\n      this.confirm.show = false\r\n    },\r\n    /**\r\n\t\t * 保存表单\r\n\t\t **/\r\n    save () {\r\n      this.confirm.show = false\r\n      let params = {}\r\n      Object.assign(params, this.formBean)\r\n      params.authps = this.formBean.platform + this.formBean.system\r\n      let httpConfig = {\r\n        url: RESOURCE_PATH,\r\n        data: params,\r\n        method: 'POST'\r\n      }\r\n      this.bdisabled = true\r\n      this.$ajax(httpConfig)\r\n        .then(resp => {\r\n          this.bdisabled = false\r\n          this.search()\r\n        })\r\n    },\r\n    /**\r\n\t\t * 返回到数据视图\r\n\t\t **/\r\n    cancel () {\r\n      let prevTab = ''\r\n      if (this.transData.tabObj) {\r\n        prevTab = this.transData.tabObj.prevTab\r\n      } else if (this.transData.prevTab) {\r\n        prevTab = this.transData.prevTab\r\n      }\r\n      let queryCache = { formBean: this.transData.formBean, currentPage: this.transData.currentPage, pageSize: this.transData.pageSize }\r\n      let backParam = { id: this.transData.previd, statusName: 'table', prevTab: prevTab, type: 'back', curTab: 'jobdetail' }\r\n      if (this.transData.jobStatus) {\r\n        queryCache.jobStatus = this.transData.jobStatus\r\n      }\r\n      if (this.transData.jobData) {\r\n        this.$emit('switch', Object.assign({}, queryCache, backParam, { prequeryCache: this.transData.queryCache }, { jobData: this.transData.jobData }))\r\n      } else {\r\n        this.$emit('switch', Object.assign({}, queryCache, backParam))\r\n      }\r\n    },\r\n    /**\r\n\t\t * 改变页码事件\r\n\t\t **/\r\n    changePage (currentPage) {\r\n      this.page.current = currentPage\r\n      this.search()\r\n    },\r\n    /**\r\n\t\t * 改变分页大小事件\r\n\t\t **/\r\n    changePageSize (pageSize) {\r\n      this.page.size = pageSize\r\n      this.search()\r\n    },\r\n\t\t    /**\r\n\t\t * 查询\r\n\t\t **/\r\n    search () {\r\n      let params = {}\r\n      params.currentPage = this.page.current\r\n      params.pageSize = this.page.size\r\n      params.job = this.formBean.job\r\n      params.platform = this.formBean.platform\r\n      params.system = this.formBean.system\r\n      let httpConfig = {\r\n        method: 'GET',\r\n        url: RESOURCE_PATH,\r\n        params: params\r\n      }\r\n\r\n      this.$ajax(httpConfig)\r\n        .then(resp => {\r\n          this.gridData = resp.data.rows\r\n          this.page.total = resp.data.total\r\n        })\r\n    }\r\n  },\r\n\r\n  /**\r\n\t * 视图挂载\r\n\t **/\r\n  mounted () {\r\n    this.queryJobTypeList()\r\n    this.queryTipList()\r\n    this.init()\r\n  }\r\n}\r\n\r\n</script>\r\n<style>\r\n#confirmM .ivu-modal-body{\r\n\tpadding:16px;font-size:12px;line-height:1.5;width: 100%;\r\n}\r\n</style>\r\n"]}]}