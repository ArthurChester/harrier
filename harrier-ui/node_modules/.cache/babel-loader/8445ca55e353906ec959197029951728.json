{"remainingRequest":"D:\\WorkSpace\\IdeaProjects\\harrier\\harrier-ui\\node_modules\\babel-loader\\lib\\index.js!D:\\WorkSpace\\IdeaProjects\\harrier\\harrier-ui\\src\\router\\index.js","dependencies":[{"path":"D:\\WorkSpace\\IdeaProjects\\harrier\\harrier-ui\\src\\router\\index.js","mtime":1681468306495},{"path":"D:\\WorkSpace\\IdeaProjects\\harrier\\harrier-ui\\.babelrc","mtime":1681468306354},{"path":"D:\\WorkSpace\\IdeaProjects\\harrier\\harrier-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\WorkSpace\\IdeaProjects\\harrier\\harrier-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport _toConsumableArray from \"D:/WorkSpace/IdeaProjects/harrier/harrier-ui/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport Vue from 'vue';\nimport Router from 'vue-router';\nimport routes from \"./routers\";\nimport store from '@/store';\nimport iView from 'iview';\nimport { setToken, getToken, canTurnTo, setTitle, localSave, localRead } from '@/libs/util';\nimport { loadMenu, formatMenu } from '@/libs/router-util';\nimport { routeindex } from '@/api/data';\nimport config from '@/config';\nimport axiosIns from '@/common/ajax.js';\nvar homeName = config.homeName;\nVue.use(Router);\n// const router = new Router({\n//   routes: [...routes, ...loadMenu()],\n//   mode: 'hash'\n// })\n// const router = new Router({\n//   routes,\n//   mode: 'hash' // history\n//   // base: '/harrier' // http://localhost:8080/harrier\n// })\nexport var createRouter = function createRouter(routers) {\n  return new Router({\n    routes: [].concat(_toConsumableArray(routes), _toConsumableArray(loadMenu())),\n    mode: 'hash' // history\n    // base: '/harrier' // http://localhost:8080/harrier\n  });\n};\n\nvar router = createRouter(routes);\nvar LOGIN_PAGE_NAME = 'login';\nvar turnTo = function turnTo(to, access, next) {\n  if (canTurnTo(to.name, access, routes)) next(); // 有权限，可访问\n  else next({\n    replace: true,\n    name: 'error_401'\n  }); // 无权限，重定向到401页面\n};\n\nrouter.beforeEach(function (to, from, next) {\n  iView.LoadingBar.start();\n  if (to.name === 'register') {\n    next();\n  } else if (to.path === '/resetPasswords') {\n    next();\n  } else {\n    var token = getToken();\n    var menu = localRead('route'); // 读取路由数据\n    if (!token && to.name !== LOGIN_PAGE_NAME) {\n      // 未登录且要跳转的页面不是登录页\n      next({\n        name: LOGIN_PAGE_NAME // 跳转到登录页\n      });\n    } else if (!token && to.name === LOGIN_PAGE_NAME) {\n      // 未登陆且要跳转的页面是登录页\n      next(); // 跳转\n    } else if (token && to.name === LOGIN_PAGE_NAME) {\n      // 已登录且要跳转的页面是登录页\n      next({\n        name: homeName // 跳转到homeName页\n      });\n    } else {\n      if (!menu || menu.length === 0) {\n        var userName = window.sessionStorage.getItem('userName');\n        var params = {};\n        params.userName = userName;\n        var _config = {\n          url: 'menu/getRouters',\n          params: params,\n          method: 'post'\n        };\n        axiosIns(_config).then(function (resp) {\n          var list = [];\n          var menuData = resp.data;\n          localSave('route', JSON.stringify(menuData));\n          // 格式化菜单\n          list = formatMenu(menuData);\n          // 将404路由动态注入，防止第一次没有路由数据跳转到404,\n          list.push({\n            path: '*',\n            name: 'error_404',\n            meta: {\n              hideInMenu: true\n            },\n            component: function component() {\n              return import('@/view/error-page/404.vue');\n            }\n          });\n          // 刷新界面菜单\n          store.commit('updateMenuList', list);\n          // next() 因为 router 版本的原因，现在改为下面这种方式。\n          router.push({\n            path: homeName\n          }).catch(function (err) {\n            console.log(err);\n          });\n        });\n      } else {\n        next();\n      }\n    }\n  }\n});\nrouter.afterEach(function (to) {\n  setTitle(to, router.app);\n  iView.LoadingBar.finish();\n  window.scrollTo(0, 0);\n});\nexport default router;",{"version":3,"names":["Vue","Router","routes","store","iView","setToken","getToken","canTurnTo","setTitle","localSave","localRead","loadMenu","formatMenu","routeindex","config","axiosIns","homeName","use","createRouter","routers","concat","_toConsumableArray","mode","router","LOGIN_PAGE_NAME","turnTo","to","access","next","name","replace","beforeEach","from","LoadingBar","start","path","token","menu","length","userName","window","sessionStorage","getItem","params","url","method","then","resp","list","menuData","data","JSON","stringify","push","meta","hideInMenu","component","commit","catch","err","console","log","afterEach","app","finish","scrollTo"],"sources":["D:/WorkSpace/IdeaProjects/harrier/harrier-ui/src/router/index.js"],"sourcesContent":["import Vue from 'vue'\r\nimport Router from 'vue-router'\r\nimport routes from './routers'\r\nimport store from '@/store'\r\nimport iView from 'iview'\r\nimport { setToken, getToken, canTurnTo, setTitle, localSave, localRead } from '@/libs/util'\r\nimport { loadMenu, formatMenu } from '@/libs/router-util'\r\nimport { routeindex\t} from '@/api/data'\r\nimport config from '@/config'\r\nimport axiosIns from '@/common/ajax.js'\r\nconst { homeName } = config\r\n\r\nVue.use(Router)\r\n// const router = new Router({\r\n//   routes: [...routes, ...loadMenu()],\r\n//   mode: 'hash'\r\n// })\r\n// const router = new Router({\r\n//   routes,\r\n//   mode: 'hash' // history\r\n//   // base: '/harrier' // http://localhost:8080/harrier\r\n// })\r\nexport const createRouter = (routers) => new Router({\r\n  routes: [...routes, ...loadMenu()],\r\n  mode: 'hash' // history\r\n  // base: '/harrier' // http://localhost:8080/harrier\r\n})\r\nconst router = createRouter(routes)\r\n\r\nconst LOGIN_PAGE_NAME = 'login'\r\nconst turnTo = (to, access, next) => {\r\n  if (canTurnTo(to.name, access, routes)) next() // 有权限，可访问\r\n  else next({ replace: true, name: 'error_401' }) // 无权限，重定向到401页面\r\n}\r\n\r\nrouter.beforeEach((to, from, next) => {\r\n  iView.LoadingBar.start()\r\n  if (to.name === 'register') {\r\n    next()\r\n  } else if (to.path === '/resetPasswords') {\r\n    next()\r\n  } else {\r\n    const token = getToken()\r\n    const menu = localRead('route') // 读取路由数据\r\n    if (!token && to.name !== LOGIN_PAGE_NAME) {\r\n      // 未登录且要跳转的页面不是登录页\r\n      next({\r\n        name: LOGIN_PAGE_NAME // 跳转到登录页\r\n      })\r\n    } else if (!token && to.name === LOGIN_PAGE_NAME) {\r\n      // 未登陆且要跳转的页面是登录页\r\n      next() // 跳转\r\n    } else if (token && to.name === LOGIN_PAGE_NAME) {\r\n      // 已登录且要跳转的页面是登录页\r\n      next({\r\n        name: homeName // 跳转到homeName页\r\n      })\r\n    } else {\r\n      if (!menu || menu.length === 0) {\r\n        const userName = window.sessionStorage.getItem('userName')\r\n        let params = {}\r\n        params.userName = userName\r\n        const config = {\r\n          url: 'menu/getRouters',\r\n          params: params,\r\n          method: 'post'\r\n        }\r\n        axiosIns(config).then(resp => {\r\n          var list = []\r\n          var menuData = resp.data\r\n          localSave('route', JSON.stringify(menuData))\r\n          // 格式化菜单\r\n          list = formatMenu(menuData)\r\n          // 将404路由动态注入，防止第一次没有路由数据跳转到404,\r\n          list.push({\r\n            path: '*',\r\n            name: 'error_404',\r\n            meta: {\r\n              hideInMenu: true\r\n            },\r\n            component: () => import('@/view/error-page/404.vue')\r\n          })\r\n          // 刷新界面菜单\r\n          store.commit('updateMenuList', list)\r\n          // next() 因为 router 版本的原因，现在改为下面这种方式。\r\n          router.push({ path: homeName }).catch(err => { console.log(err) })\r\n        })\r\n      } else {\r\n        next()\r\n      }\r\n    }\r\n  }\r\n})\r\n\r\nrouter.afterEach(to => {\r\n  setTitle(to, router.app)\r\n  iView.LoadingBar.finish()\r\n  window.scrollTo(0, 0)\r\n})\r\n\r\nexport default router\r\n"],"mappings":"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"}]}