{"remainingRequest":"D:\\WorkSpace\\IdeaProjects\\harrier\\harrier-ui\\node_modules\\babel-loader\\lib\\index.js!D:\\WorkSpace\\IdeaProjects\\harrier\\harrier-ui\\src\\libs\\axios.js","dependencies":[{"path":"D:\\WorkSpace\\IdeaProjects\\harrier\\harrier-ui\\src\\libs\\axios.js","mtime":1681468306487},{"path":"D:\\WorkSpace\\IdeaProjects\\harrier\\harrier-ui\\.babelrc","mtime":1681468306354},{"path":"D:\\WorkSpace\\IdeaProjects\\harrier\\harrier-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\WorkSpace\\IdeaProjects\\harrier\\harrier-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.keys\";\nimport _classCallCheck from \"D:/WorkSpace/IdeaProjects/harrier/harrier-ui/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"D:/WorkSpace/IdeaProjects/harrier/harrier-ui/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport \"core-js/modules/es7.array.includes\";\nimport \"core-js/modules/es6.string.includes\";\nimport axios from 'axios';\nimport store from '@/store';\n// import { Spin } from 'iview'\nvar addErrorLog = function addErrorLog(errorInfo) {\n  var statusText = errorInfo.statusText,\n    status = errorInfo.status,\n    responseURL = errorInfo.request.responseURL;\n  var info = {\n    type: 'ajax',\n    code: status,\n    mes: statusText,\n    url: responseURL\n  };\n  if (!responseURL.includes('save_error_logger')) store.dispatch('addErrorLog', info);\n};\nvar HttpRequest = /*#__PURE__*/function () {\n  function HttpRequest() {\n    var baseUrl = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : baseURL;\n    _classCallCheck(this, HttpRequest);\n    this.baseUrl = baseUrl;\n    this.queue = {};\n  }\n  _createClass(HttpRequest, [{\n    key: \"getInsideConfig\",\n    value: function getInsideConfig() {\n      var config = {\n        baseURL: this.baseUrl,\n        headers: {\n          //\n        }\n      };\n      return config;\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy(url) {\n      delete this.queue[url];\n      if (!Object.keys(this.queue).length) {\n        // Spin.hide()\n      }\n    }\n  }, {\n    key: \"interceptors\",\n    value: function interceptors(instance, url) {\n      var _this = this;\n      // 请求拦截\n      instance.interceptors.request.use(function (config) {\n        // 添加全局的loading...\n        if (!Object.keys(_this.queue).length) {\n          // Spin.show() // 不建议开启，因为界面不友好\n        }\n        _this.queue[url] = true;\n        return config;\n      }, function (error) {\n        return Promise.reject(error);\n      });\n      // 响应拦截\n      instance.interceptors.response.use(function (res) {\n        _this.destroy(url);\n        var data = res.data,\n          status = res.status;\n        return {\n          data: data,\n          status: status\n        };\n      }, function (error) {\n        _this.destroy(url);\n        var errorInfo = error.response;\n        if (!errorInfo) {\n          var _JSON$parse = JSON.parse(JSON.stringify(error)),\n            _JSON$parse$request = _JSON$parse.request,\n            statusText = _JSON$parse$request.statusText,\n            status = _JSON$parse$request.status,\n            config = _JSON$parse.config;\n          errorInfo = {\n            statusText: statusText,\n            status: status,\n            request: {\n              responseURL: config.url\n            }\n          };\n        }\n        addErrorLog(errorInfo);\n        return Promise.reject(error);\n      });\n    }\n  }, {\n    key: \"request\",\n    value: function request(options) {\n      var instance = axios.create();\n      options = Object.assign(this.getInsideConfig(), options);\n      this.interceptors(instance, options.url);\n      return instance(options);\n    }\n  }]);\n  return HttpRequest;\n}();\nexport default HttpRequest;",{"version":3,"names":["axios","store","addErrorLog","errorInfo","statusText","status","responseURL","request","info","type","code","mes","url","includes","dispatch","HttpRequest","baseUrl","arguments","length","undefined","baseURL","_classCallCheck","queue","_createClass","key","value","getInsideConfig","config","headers","destroy","Object","keys","interceptors","instance","_this","use","error","Promise","reject","response","res","data","_JSON$parse","JSON","parse","stringify","_JSON$parse$request","options","create","assign"],"sources":["D:/WorkSpace/IdeaProjects/harrier/harrier-ui/src/libs/axios.js"],"sourcesContent":["import axios from 'axios'\r\nimport store from '@/store'\r\n// import { Spin } from 'iview'\r\nconst addErrorLog = errorInfo => {\r\n  const { statusText, status, request: { responseURL } } = errorInfo\r\n  let info = {\r\n    type: 'ajax',\r\n    code: status,\r\n    mes: statusText,\r\n    url: responseURL\r\n  }\r\n  if (!responseURL.includes('save_error_logger')) store.dispatch('addErrorLog', info)\r\n}\r\n\r\nclass HttpRequest {\r\n  constructor (baseUrl = baseURL) {\r\n    this.baseUrl = baseUrl\r\n    this.queue = {}\r\n  }\r\n  getInsideConfig () {\r\n    const config = {\r\n      baseURL: this.baseUrl,\r\n      headers: {\r\n        //\r\n      }\r\n    }\r\n    return config\r\n  }\r\n  destroy (url) {\r\n    delete this.queue[url]\r\n    if (!Object.keys(this.queue).length) {\r\n      // Spin.hide()\r\n    }\r\n  }\r\n  interceptors (instance, url) {\r\n    // 请求拦截\r\n    instance.interceptors.request.use(config => {\r\n      // 添加全局的loading...\r\n      if (!Object.keys(this.queue).length) {\r\n        // Spin.show() // 不建议开启，因为界面不友好\r\n      }\r\n      this.queue[url] = true\r\n      return config\r\n    }, error => {\r\n      return Promise.reject(error)\r\n    })\r\n    // 响应拦截\r\n    instance.interceptors.response.use(res => {\r\n      this.destroy(url)\r\n      const { data, status } = res\r\n      return { data, status }\r\n    }, error => {\r\n      this.destroy(url)\r\n      let errorInfo = error.response\r\n      if (!errorInfo) {\r\n        const { request: { statusText, status }, config } = JSON.parse(JSON.stringify(error))\r\n        errorInfo = {\r\n          statusText,\r\n          status,\r\n          request: { responseURL: config.url }\r\n        }\r\n      }\r\n      addErrorLog(errorInfo)\r\n      return Promise.reject(error)\r\n    })\r\n  }\r\n  request (options) {\r\n    const instance = axios.create()\r\n    options = Object.assign(this.getInsideConfig(), options)\r\n    this.interceptors(instance, options.url)\r\n    return instance(options)\r\n  }\r\n}\r\nexport default HttpRequest\r\n"],"mappings":"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"}]}